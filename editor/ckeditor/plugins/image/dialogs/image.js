/*
 Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.
 For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
*/
!function(){var t=function(t,e){function i(){var t=arguments,e=this.getContentElement("advanced","txtdlgGenStyle");e&&e.commit.apply(e,t),this.foreach(function(e){e.commit&&"txtdlgGenStyle"!=e.id&&e.commit.apply(e,t)})}function n(t){if(!a){a=1;var e=this.getDialog(),i=e.imageElement;if(i){this.commit(s,i);for(var n,l=(t=[].concat(t)).length,o=0;o<l;o++)(n=e.getContentElement.apply(e,t[o].split(":")))&&n.setup(s,i)}a=0}}var a,l,s=1,o=/^\s*(\d+)((px)|\%)?\s*$/i,r=/(^\s*(\d+)((px)|\%)?\s*$)|^$/i,m=function(t){return t.originalElement&&t.preview?(t.commitContent(4,t.preview),0):1},g=function(t,e){if(!t.getContentElement("info","ratioLock"))return null;var i=t.originalElement;if(!i)return null;if("check"==e){if(!t.userlockRatio&&"true"==i.getCustomData("isReady")){var n=t.getValueOf("info","txtWidth"),a=t.getValueOf("info","txtHeight"),l=1e3*i.$.width/i.$.height,s=1e3*n/a;t.lockRatio=!1,n||a?isNaN(l)||isNaN(s)||Math.round(l)==Math.round(s)&&(t.lockRatio=!1):t.lockRatio=!0}}else void 0!==e?t.lockRatio=e:(t.userlockRatio=1,t.lockRatio=!t.lockRatio);var o=CKEDITOR.document.getById(p);return t.lockRatio?o.removeClass("cke_btn_unlocked"):o.addClass("cke_btn_unlocked"),o.setAttribute("aria-checked",t.lockRatio),CKEDITOR.env.hc&&o.getChild(0).setHtml(t.lockRatio?CKEDITOR.env.ie?"■":"▣":CKEDITOR.env.ie?"□":"▢"),t.lockRatio},d=function(t,e){var i=t.originalElement;if("true"==i.getCustomData("isReady")){var n,a,l=t.getContentElement("info","txtWidth"),s=t.getContentElement("info","txtHeight");e?(n=0,a=0):(n=i.$.width,a=i.$.height),l&&l.setValue(n),s&&s.setValue(a)}m(t)},h=function(){var e=this.originalElement,i=CKEDITOR.document.getById(v);e.setCustomData("isReady","true"),e.removeListener("load",h),e.removeListener("error",c),e.removeListener("abort",c),i&&i.setStyle("display","none"),this.dontResetSize||d(this,!1===t.config.image_prefillDimensions),this.firstLoad&&CKEDITOR.tools.setTimeout(function(){g(this,"check")},0,this),this.firstLoad=!1,this.dontResetSize=!1,m(this)},c=function(){var t=this.originalElement,e=CKEDITOR.document.getById(v);t.removeListener("load",h),t.removeListener("error",c),t.removeListener("abort",c);var i=CKEDITOR.getUrl(CKEDITOR.plugins.get("image").path+"images/noimage.png");this.preview&&this.preview.setAttribute("src",i),e&&e.setStyle("display","none"),g(this,!1)},u=function(t){return CKEDITOR.tools.getNextId()+"_"+t},p=u("btnLockSizes"),f=u("btnResetSize"),v=u("ImagePreviewLoader"),b=u("previewLink"),E=u("previewImage");return{title:t.lang.image["image"==e?"title":"titleButton"],minWidth:"moono-lisa"==(CKEDITOR.skinName||t.config.skin)?500:420,minHeight:360,onShow:function(){this.imageElement=!1,this.linkElement=!1,this.imageEditMode=!1,this.linkEditMode=!1,this.lockRatio=!0,this.userlockRatio=0,this.dontResetSize=!1,this.firstLoad=!0,this.addLink=!1;var t=this.getParentEditor(),i=t.getSelection(),n=i&&i.getSelectedElement(),a=n&&t.elementPath(n).contains("a",1),o=CKEDITOR.document.getById(v);if(o&&o.setStyle("display","none"),l=new CKEDITOR.dom.element("img",t.document),this.preview=CKEDITOR.document.getById(E),this.originalElement=t.document.createElement("img"),this.originalElement.setAttribute("alt",""),this.originalElement.setCustomData("isReady","false"),a){this.linkElement=a,this.linkEditMode=!0,this.addLink=!0;var r=a.getChildren();if(1==r.count()){var m=r.getItem(0);m.type==CKEDITOR.NODE_ELEMENT&&(m.is("img")||m.is("input"))&&(this.imageElement=r.getItem(0),this.imageElement.is("img")?this.imageEditMode="img":this.imageElement.is("input")&&(this.imageEditMode="input"))}"image"==e&&this.setupContent(2,a)}this.customImageElement?(this.imageEditMode="img",this.imageElement=this.customImageElement,delete this.customImageElement):(n&&"img"==n.getName()&&!n.data("cke-realelement")||n&&"input"==n.getName()&&"image"==n.getAttribute("type"))&&(this.imageEditMode=n.getName(),this.imageElement=n),this.imageEditMode&&(this.cleanImageElement=this.imageElement,this.imageElement=this.cleanImageElement.clone(!0,!0),this.setupContent(s,this.imageElement)),g(this,!0),CKEDITOR.tools.trim(this.getValueOf("info","txtUrl"))||(this.preview.removeAttribute("src"),this.preview.setStyle("display","none"))},onOk:function(){if(this.imageEditMode){var i=this.imageEditMode;"image"==e&&"input"==i&&confirm(t.lang.image.button2Img)?(i="img",this.imageElement=t.document.createElement("img"),this.imageElement.setAttribute("alt",""),t.insertElement(this.imageElement)):"image"!=e&&"img"==i&&confirm(t.lang.image.img2Button)?(i="input",this.imageElement=t.document.createElement("input"),this.imageElement.setAttributes({type:"image",alt:""}),t.insertElement(this.imageElement)):(this.imageElement=this.cleanImageElement,delete this.cleanImageElement)}else"image"==e?this.imageElement=t.document.createElement("img"):(this.imageElement=t.document.createElement("input"),this.imageElement.setAttribute("type","image")),this.imageElement.setAttribute("alt","");if(this.linkEditMode||(this.linkElement=t.document.createElement("a")),this.commitContent(s,this.imageElement),this.commitContent(2,this.linkElement),this.imageElement.getAttribute("style")||this.imageElement.removeAttribute("style"),this.imageElement.getAttribute("data-photo-src")){var n=this.imageElement.getAttribute("src"),a=this.imageElement.getAttribute("style"),l=t.document.createElement("div");l.addClass("olala-vp360"),l.setAttribute("data-photo-src",n),this.imageElement=t.document.createElement("div"),this.imageElement.addClass("box-vp360"),this.imageElement.setAttribute("style",a),this.imageElement.append(l)}this.imageEditMode?!this.linkEditMode&&this.addLink?(t.insertElement(this.linkElement),this.imageElement.appendTo(this.linkElement)):this.linkEditMode&&!this.addLink&&(t.getSelection().selectElement(this.linkElement),t.insertElement(this.imageElement)):this.addLink?this.linkEditMode?this.linkElement.equals(t.getSelection().getSelectedElement())?(this.linkElement.setHtml(""),this.linkElement.append(this.imageElement,!1)):t.insertElement(this.imageElement):(t.insertElement(this.linkElement),this.linkElement.append(this.imageElement,!1)):t.insertElement(this.imageElement)},onLoad:function(){"image"!=e&&this.hidePage("Link");var t=this._.element.getDocument();this.getContentElement("info","ratioLock")&&(this.addFocusable(t.getById(f),5),this.addFocusable(t.getById(p),5)),this.commitContent=i},onHide:function(){this.preview&&this.commitContent(8,this.preview),this.originalElement&&(this.originalElement.removeListener("load",h),this.originalElement.removeListener("error",c),this.originalElement.removeListener("abort",c),this.originalElement.remove(),this.originalElement=!1),delete this.imageElement},contents:[{id:"info",label:t.lang.image.infoTab,accessKey:"I",elements:[{type:"vbox",padding:0,children:[{type:"hbox",widths:["280px","110px"],align:"right",className:"cke_dialog_image_url",children:[{id:"txtUrl",type:"text",label:t.lang.common.url,required:!0,onChange:function(){var t=this.getDialog(),e=this.getValue();if(e.length>0){var i=(t=this.getDialog()).originalElement;t.preview&&t.preview.removeStyle("display"),i.setCustomData("isReady","false");var n=CKEDITOR.document.getById(v);n&&n.setStyle("display",""),i.on("load",h,t),i.on("error",c,t),i.on("abort",c,t),i.setAttribute("src",e),t.preview&&(l.setAttribute("src",e),t.preview.setAttribute("src",l.$.src),m(t))}else t.preview&&(t.preview.removeAttribute("src"),t.preview.setStyle("display","none"))},setup:function(t,e){if(t==s){var i=e.data("cke-saved-src")||e.getAttribute("src"),n=this;this.getDialog().dontResetSize=!0,n.setValue(i),n.setInitValue()}},commit:function(t,e){t==s&&(this.getValue()||this.isChanged())?(e.data("cke-saved-src",this.getValue()),e.setAttribute("src",this.getValue())):8==t&&(e.setAttribute("src",""),e.removeAttribute("src"))},validate:CKEDITOR.dialog.validate.notEmpty(t.lang.image.urlMissing)},{type:"button",id:"browse",style:"display:inline-block;margin-top:14px;",align:"center",label:t.lang.common.browseServer,hidden:!0,filebrowser:"info:txtUrl"}]}]},{id:"txtAlt",type:"text",label:t.lang.image.alt,accessKey:"T",default:"",onChange:function(){m(this.getDialog())},setup:function(t,e){t==s&&this.setValue(e.getAttribute("alt"))},commit:function(t,e){t==s?(this.getValue()||this.isChanged())&&e.setAttribute("alt",this.getValue()):4==t?e.setAttribute("alt",this.getValue()):8==t&&e.removeAttribute("alt")}},{type:"hbox",widths:["50%","50%"],children:[{id:"basic",type:"vbox",children:[{type:"hbox",requiredContent:"img{width,height}",widths:["50%","50%"],children:[{type:"vbox",padding:1,children:[{type:"text",width:"60px",id:"txtWidth",label:t.lang.common.width,onKeyUp:function(){var t=this.getValue(),e=this.getDialog(),i=t.match(o);if(i&&("%"==i[2]&&g(e,!1),t=i[1]),e.lockRatio){var n=e.originalElement;"true"==n.getCustomData("isReady")&&("txtHeight"==this.id?(t&&"0"!=t&&(t=Math.round(n.$.width*(t/n.$.height))),isNaN(t)||e.setValueOf("info","txtWidth",t)):(t&&"0"!=t&&(t=Math.round(n.$.height*(t/n.$.width))),isNaN(t)||e.setValueOf("info","txtHeight",t)))}m(e)},onChange:function(){n.call(this,"advanced:txtdlgGenStyle")},validate:function(){var e=this.getValue().match(r),i=!(!e||0===parseInt(e[1],10));return i||alert(t.lang.common.invalidWidth),i},setup:function(t,e){function i(t,e){var i=t.match(o);return i?("%"==i[2]&&(i[1]+="%",g(n,!1)),i[1]):e}if(t==s){var n=this.getDialog(),a="",l="txtWidth"==this.id?"width":"height",r=e.getAttribute(l);r&&(a=i(r,a)),a=i(e.getStyle(l),a),this.setValue(a)}},commit:function(e,i){var n=this.getValue();e==s?(n&&t.activeFilter.check("img{width,height}")?i.setStyle("max-width","100%"):i.removeStyle("width"),i.removeAttribute("width")):4==e?n.match(o)?i.setStyle("max-width","100%"):"true"==this.getDialog().originalElement.getCustomData("isReady")&&i.setStyle("max-width","100%"):8==e&&(i.removeAttribute("width"),i.removeStyle("width"))}},{type:"text",id:"txtHeight",width:"60px",label:t.lang.common.height,validate:function(){var e=this.getValue().match(r),i=!(!e||0===parseInt(e[1],10));return i||alert(t.lang.common.invalidHeight),i}}]},{id:"ratioLock",type:"html",className:"cke_dialog_image_ratiolock",style:"margin-top:30px;width:40px;height:40px;",onLoad:function(){var t=CKEDITOR.document.getById(f),e=CKEDITOR.document.getById(p);t&&(t.on("click",function(t){d(this),t.data&&t.data.preventDefault()},this.getDialog()),t.on("mouseover",function(){this.addClass("cke_btn_over")},t),t.on("mouseout",function(){this.removeClass("cke_btn_over")},t)),e&&(e.on("click",function(t){g(this);var e=this.originalElement,i=this.getValueOf("info","txtWidth");if("true"==e.getCustomData("isReady")&&i){var n=e.$.height/e.$.width*i;isNaN(n)||(this.setValueOf("info","txtHeight",Math.round(n)),m(this))}t.data&&t.data.preventDefault()},this.getDialog()),e.on("mouseover",function(){this.addClass("cke_btn_over")},e),e.on("mouseout",function(){this.removeClass("cke_btn_over")},e))},html:'<div><a href="javascript:void(0)" tabindex="-1" title="'+t.lang.image.lockRatio+'" class="cke_btn_locked" id="'+p+'" role="checkbox"><span class="cke_icon"></span><span class="cke_label">'+t.lang.image.lockRatio+'</span></a><a href="javascript:void(0)" tabindex="-1" title="'+t.lang.image.resetSize+'" class="cke_btn_reset" id="'+f+'" role="button"><span class="cke_label">'+t.lang.image.resetSize+"</span></a></div>"}]},{type:"vbox",padding:1,children:[{type:"text",id:"txtBorder",requiredContent:"img{border-width}",width:"60px",label:t.lang.image.border,default:"",onKeyUp:function(){m(this.getDialog())},onChange:function(){n.call(this,"advanced:txtdlgGenStyle")},validate:CKEDITOR.dialog.validate.integer(t.lang.image.validateBorder),setup:function(t,e){if(t==s){var i,n=e.getStyle("border-width");i=(n=n&&n.match(/^(\d+px)(?: \1 \1 \1)?$/))&&parseInt(n[1],10),isNaN(parseInt(i,10))&&(i=e.getAttribute("border")),this.setValue(i)}},commit:function(t,e){var i=parseInt(this.getValue(),10);t==s||4==t?(isNaN(i)?!i&&this.isChanged()&&e.removeStyle("border"):(e.setStyle("border-width",CKEDITOR.tools.cssLength(i)),e.setStyle("border-style","solid")),t==s&&e.removeAttribute("border")):8==t&&(e.removeAttribute("border"),e.removeStyle("border-width"),e.removeStyle("border-style"),e.removeStyle("border-color"))}},{id:"cmbAlign",requiredContent:"img{float}",type:"select",widths:["35%","65%"],style:"width:150px",label:t.lang.common.align,default:"",items:[[t.lang.common.notSet,""],[t.lang.common.alignLeft,"left"],[t.lang.common.alignRight,"right"]],onChange:function(){m(this.getDialog()),n.call(this,"advanced:txtdlgGenStyle")},setup:function(t,e){if(t==s){var i=e.getStyle("float");switch(i){case"inherit":case"none":i=""}!i&&(i=(e.getAttribute("align")||"").toLowerCase()),this.setValue(i)}},commit:function(t,e){var i=this.getValue();if(t==s||4==t){if(i?e.setStyle("float",i):e.removeStyle("float"),t==s)switch(i=(e.getAttribute("align")||"").toLowerCase()){case"left":case"right":e.removeAttribute("align")}}else 8==t&&e.removeStyle("float")}}]}]},{type:"vbox",height:"250px",children:[{id:"photo360",type:"checkbox",label:t.lang.image.photo360,setup:function(t,e){t==s&&e.getAttribute("data-photo-src")?this.setValue(!0):this.setValue(!1)},commit:function(t,e){if(t==s){var i=this.getValue();i&&e.setAttribute("data-photo-src",i)}}},{type:"html",id:"htmlPreview",style:"width:100%;position:relative;",html:'<div><div id="'+v+'" class="ImagePreviewLoader" style="display:none"><div class="loading">&nbsp;</div></div><div class="ImagePreviewBox"><table><tr><td><a href="javascript:void(0)" target="_blank" onclick="return false;" id="'+b+'" style="display:block;line-height:0;"><img style="max-width: 100%; max-height: 200px;" id="'+E+'" alt="" /></a>'+(t.config.image_previewText||"")+"</td></tr></table></div></div>"}]}]}]},{id:"Link",requiredContent:"a[href]",label:t.lang.image.linkTab,padding:0,elements:[{id:"txtUrl",type:"text",label:t.lang.common.url,style:"width: 100%",default:"",setup:function(t,e){if(2==t){var i=e.data("cke-saved-href");i||(i=e.getAttribute("href")),this.setValue(i)}},commit:function(e,i){if(2==e&&(this.getValue()||this.isChanged())){var n=this.getValue();i.data("cke-saved-href",n),i.setAttribute("href",n),this.getValue()||!t.config.image_removeLinkByEmptyURL?this.getDialog().addLink=!0:this.getDialog().addLink=!1}}},{type:"button",id:"browse",className:"cke_dialog_image_browse",filebrowser:{action:"Browse",target:"Link:txtUrl",url:t.config.filebrowserImageBrowseLinkUrl},style:"float:right",hidden:!0,label:t.lang.common.browseServer},{id:"cmbTarget",type:"select",requiredContent:"a[target]",label:t.lang.common.target,default:"",items:[[t.lang.common.notSet,""],[t.lang.common.targetNew,"_blank"],[t.lang.common.targetTop,"_top"],[t.lang.common.targetSelf,"_self"],[t.lang.common.targetParent,"_parent"]],setup:function(t,e){2==t&&this.setValue(e.getAttribute("target")||"")},commit:function(t,e){2==t&&(this.getValue()||this.isChanged())&&e.setAttribute("target",this.getValue())}}]},{id:"Upload",hidden:!0,filebrowser:"uploadButton",label:t.lang.image.upload,elements:[{type:"file",id:"upload",label:t.lang.image.btnUpload,style:"height:40px",size:38},{type:"fileButton",id:"uploadButton",filebrowser:"info:txtUrl",label:t.lang.image.btnUpload,for:["Upload","upload"]}]},{id:"advanced",label:t.lang.common.advancedTab,elements:[{type:"hbox",widths:["50%","25%","25%"],children:[{type:"text",id:"linkId",requiredContent:"img[id]",label:t.lang.common.id,setup:function(t,e){t==s&&this.setValue(e.getAttribute("id"))},commit:function(t,e){t==s&&(this.getValue()||this.isChanged())&&e.setAttribute("id",this.getValue())}},{id:"cmbLangDir",type:"select",requiredContent:"img[dir]",style:"width : 100px;",label:t.lang.common.langDir,default:"",items:[[t.lang.common.notSet,""],[t.lang.common.langDirLtr,"ltr"],[t.lang.common.langDirRtl,"rtl"]],setup:function(t,e){t==s&&this.setValue(e.getAttribute("dir"))},commit:function(t,e){t==s&&(this.getValue()||this.isChanged())&&e.setAttribute("dir",this.getValue())}},{type:"text",id:"txtLangCode",requiredContent:"img[lang]",label:t.lang.common.langCode,default:"",setup:function(t,e){t==s&&this.setValue(e.getAttribute("lang"))},commit:function(t,e){t==s&&(this.getValue()||this.isChanged())&&e.setAttribute("lang",this.getValue())}}]},{type:"text",id:"txtGenLongDescr",requiredContent:"img[longdesc]",label:t.lang.common.longDescr,setup:function(t,e){t==s&&this.setValue(e.getAttribute("longDesc"))},commit:function(t,e){t==s&&(this.getValue()||this.isChanged())&&e.setAttribute("longDesc",this.getValue())}},{type:"hbox",widths:["60%","40%"],children:[{type:"text",id:"txtGenClass",requiredContent:"img(cke-xyz)",label:t.lang.common.cssClass,default:"",setup:function(t,e){t==s&&this.setValue(e.getAttribute("class"))},commit:function(t,e){t==s&&(this.getValue()||this.isChanged())&&e.setAttribute("class",this.getValue())}},{type:"text",id:"txtGenTitle",requiredContent:"img[title]",label:t.lang.common.advisoryTitle,default:"",onChange:function(){m(this.getDialog())},setup:function(t,e){t==s&&this.setValue(e.getAttribute("title"))},commit:function(t,e){t==s?(this.getValue()||this.isChanged())&&e.setAttribute("title",this.getValue()):4==t?e.setAttribute("title",this.getValue()):8==t&&e.removeAttribute("title")}}]},{type:"text",id:"txtdlgGenStyle",requiredContent:"img{cke-xyz}",label:t.lang.common.cssStyle,validate:CKEDITOR.dialog.validate.inlineStyle(t.lang.common.invalidInlineStyle),default:"",setup:function(t,e){if(t==s){var i=e.getAttribute("style");!i&&e.$.style.cssText&&(i=e.$.style.cssText),this.setValue(i);var n=e.$.style.height,a=e.$.style.width,l=(n||"").match(o),r=(a||"").match(o);this.attributesInStyle={height:!!l,width:!!r}}},onChange:function(){n.call(this,["info:cmbAlign","info:txtBorder"]),m(this)},commit:function(t,e){t==s&&(this.getValue()||this.isChanged())&&e.setAttribute("style",this.getValue())}}]}]}};CKEDITOR.dialog.add("image",function(e){return t(e,"image")}),CKEDITOR.dialog.add("imagebutton",function(e){return t(e,"imagebutton")})}();